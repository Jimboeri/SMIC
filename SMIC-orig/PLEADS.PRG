* STKPRNT - PRINT MODULES SOLD
* JIM WEST
* 12/88

IF .NOT. NET_USE('NEWLEADS', .F.)
  RETURN
ENDIF

DECLARE JGOOD[8], JTOT[8]
DECLARE PGOOD[8], PTOT[8]
DECLARE FGOOD[8], FTOT[8]
DECLARE NGOOD[8], NTOT[8]
DECLARE DGOOD[8], DTOT[8]
DECLARE CGOOD[8], CTOT[8]
DECLARE EGOOD[8], ETOT[8]
DECLARE OGOOD[8], OTOT[8]

AFILL(JGOOD, 0)
AFILL(JTOT, 0)
AFILL(PGOOD, 0)
AFILL(PTOT, 0)
AFILL(FGOOD, 0)
AFILL(FTOT, 0)
AFILL(NGOOD, 0)
AFILL(NTOT, 0)
AFILL(DGOOD, 0)
AFILL(DTOT, 0)
AFILL(CGOOD, 0)
AFILL(CTOT, 0)
AFILL(EGOOD, 0)
AFILL(ETOT, 0)
AFILL(OGOOD, 0)
AFILL(OTOT, 0)

DECLARE TDT[8]
AFILL(TDT, CTOD('  /  /  '))

STORE 0 TO TLEAD1, TLEAD2, TLEAD3, TLEAD4, TLEAD5, TLEAD6, TLEAD7, TLEAD8

SIMHEAD(PSCR_TITLE)
STORE CTOD('  /  /  ') TO MSTART_DT
@10,0 SAY 'Enter start sales date for report ' GET MSTART_DT PICTURE '@D'
READ
STORE 'X' TO YESNO
DO WHILE 'Y'<>YESNO .AND. 'N'<>YESNO
  @13,0 CLEAR
  WAIT 'PROCEED (Y/N) ? ' TO YESNO
  STORE UPPER(YESNO) TO YESNO
ENDDO
IF 'N'=YESNO
  CLOSE DATABASES
  RETURN
ENDIF

MCNT = 1
JIMDT = MSTART_DT
DO WHILE MCNT < 9
  DO WHILE DOW(JIMDT) <> 1
    JIMDT = JIMDT+1
  ENDDO
  STORE JIMDT TO TDT[MCNT]
  JIMDT++
  MCNT++
ENDDO

SET PRINT ON
@4,0 CLEAR
@7,5 SAY 'PRINTING LEADS RECEIVED'
SET CONSOL OFF
STORE 'LEADS RECEIVED ' TO SUBTITLE
SUBTITLE = SUBTITLE + ' FROM ' + DTOC(MSTART_DT)
SUBTITLE = SUBTITLE + ' TO ' + DTOC(TDT[8])
STORE 0 TO PPAGE
STORE 70 TO PLINE
GO TOP
DO WHILE .NOT. EOF()
  DO CASE
    CASE DATE_RCVD >= MSTART_DT .AND. DATE_RCVD <= TDT[1]
      BRCOUNT(1)
    CASE DATE_RCVD > TDT[1] .AND. DATE_RCVD <= TDT[2]
      BRCOUNT(2)
    CASE DATE_RCVD > TDT[2] .AND. DATE_RCVD <= TDT[3]
      BRCOUNT(3)
    CASE DATE_RCVD > TDT[3] .AND. DATE_RCVD <= TDT[4]
      BRCOUNT(4)
    CASE DATE_RCVD > TDT[4] .AND. DATE_RCVD <= TDT[5]
      BRCOUNT(5)
    CASE DATE_RCVD > TDT[5] .AND. DATE_RCVD <= TDT[6]
      BRCOUNT(6)
    CASE DATE_RCVD > TDT[6] .AND. DATE_RCVD <= TDT[7]
      BRCOUNT(7)
    CASE DATE_RCVD > TDT[7] .AND. DATE_RCVD <= TDT[8]
      BRCOUNT(8)
  ENDCASE
  SKIP
ENDDO
SIMTITLE(PLINE,PPAGE,SUBTITLE,'Y')
? ' '
? 'WEEK          Jhb         Pretoria    O.F.S.      N.Tvl       Durban      Cape town   E.Cape      Other'
? ' '
MCNT = 1
FOR MCNT = 1 TO 8
  ? STR(MCNT,4,0) + '     ' + STR(JGOOD[MCNT],12,0) + STR(PGOOD[MCNT],12,0) + STR(FGOOD[MCNT],12,0) + STR(NGOOD[MCNT],12,0) + STR(DGOOD[MCNT],12,0) + STR(CGOOD[MCNT],12,0) + STR(EGOOD[MCNT],12,0) + STR(OGOOD[MCNT],12,0)
  ? '         ' + STR(JTOT[MCNT],12,0) + STR(PTOT[MCNT],12,0) + STR(FTOT[MCNT],12,0) + STR(NTOT[MCNT],12,0) + STR(DTOT[MCNT],12,0) + STR(CTOT[MCNT],12,0) + STR(ETOT[MCNT],12,0) + STR(OTOT[MCNT],12,0)
  ? ' '
NEXT
shutprn()
CLOSE DATABASES
RETURN

*EOF

***********************************************************
PROCEDURE BRCOUNT
PARAMETER WKCNT
P_CDE = SUBSTR(P_CODE,1,4)
P_NUM = VAL(P_CODE)
MMISC2 = SUBSTR(MISC_CD,2,1)
DO CASE
  CASE (P_NUM > 1400 .AND. P_NUM < 2800)
    IF MMISC2 = 'G'
      JGOOD[WKCNT]++
    ENDIF
    JTOT[WKCNT]++
  CASE (P_NUM > 0 .AND. P_NUM < 400);
             .OR. (P_NUM > 999 .AND. P_NUM < 1400);
             .OR. (P_NUM > 2799 .AND. P_NUM < 2900)
    IF MMISC2 = 'G'
      PGOOD[WKCNT]++
    ENDIF
    PTOT[WKCNT]++
  CASE (P_NUM > 399 .AND. P_NUM < 1000)
    IF MMISC2 = 'G'
      NGOOD[WKCNT]++
    ENDIF
    NTOT[WKCNT]++
  CASE (P_NUM > 9299 .AND. P_NUM < 10000);
             .OR. (P_NUM > 8299 .AND. P_NUM < 9000)
    IF MMISC2 = 'G'
      FGOOD[WKCNT]++
    ENDIF
    FTOT[WKCNT]++
  CASE (P_NUM > 6699 .AND. P_NUM < 8300)
    IF MMISC2 = 'G'
      CGOOD[WKCNT]++
    ENDIF
    CTOT[WKCNT]++
  CASE (P_NUM > 2899 .AND. P_NUM < 4900)
    IF MMISC2 = 'G'
      DGOOD[WKCNT]++
    ENDIF
    DTOT[WKCNT]++
  CASE (P_NUM > 4899 .AND. P_NUM < 6700)
    IF MMISC2 = 'G'
      EGOOD[WKCNT]++
    ENDIF
    ETOT[WKCNT]++
  OTHERWISE
    IF MMISC2 = 'G'
      OGOOD[WKCNT]++
    ENDIF
    OTOT[WKCNT]++
ENDCASE
RETURN

* EOF