* STKPRNT - PRINT MODULES SOLD
* JIM WEST
* 12/88

IF .NOT. NET_USE('STUDENT', .F.)
  RETURN
ENDIF

DECLARE JCRS1[8]
DECLARE PCRS1[8]
DECLARE FCRS1[8]
DECLARE NCRS1[8]
DECLARE DCRS1[8]
DECLARE CCRS1[8]
DECLARE ECRS1[8]
DECLARE OCRS1[8]

AFILL(JCRS1, 0)
AFILL(PCRS1, 0)
AFILL(FCRS1, 0)
AFILL(NCRS1, 0)
AFILL(DCRS1, 0)
AFILL(CCRS1, 0)
AFILL(ECRS1, 0)
AFILL(OCRS1, 0)

DECLARE TDT[8]
AFILL(TDT, CTOD('  /  /  '))

DO SIMHEAD WITH PSCR_TITLE
STORE CTOD('  /  /  ') TO MSTART_DT
@10,0 SAY 'Enter start sales date for report ' GET MSTART_DT PICTURE '@D'
READ
STORE 'X' TO YESNO
DO WHILE 'Y'<>YESNO .AND. 'N'<>YESNO
  @13,0 CLEAR
  WAIT 'PROCEED (Y/N) ? ' TO YESNO
  STORE UPPER(YESNO) TO YESNO
ENDDO
IF 'N'=YESNO
  CLOSE DATABASES
  RETURN
ENDIF

MCNT = 1
JIMDT = MSTART_DT
DO WHILE MCNT < 9
  DO WHILE DOW(JIMDT) <> 1
    JIMDT = JIMDT + 1
  ENDDO
  STORE JIMDT TO TDT[MCNT]
  JIMDT = JIMDT + 1
  MCNT = MCNT + 1
ENDDO

SET PRINT ON
@4,0 CLEAR
@7,5 SAY 'PRINTING ORDERS RECEIVED'
SET CONSOL OFF
STORE 'ORDERS RECEIVED ' TO SUBTITLE
SUBTITLE = SUBTITLE + ' FROM ' + DTOC(MSTART_DT)
SUBTITLE = SUBTITLE + ' TO ' + DTOC(TDT[8])
STORE 0 TO PPAGE
STORE 70 TO PLINE
GO TOP
DO WHILE .NOT. EOF()
  DO CASE
    CASE SOLD_CRS_1 >= MSTART_DT .AND. SOLD_CRS_1 <= TDT[1]
      DO BRADD WITH 1
    CASE SOLD_CRS_1 > TDT[1] .AND. SOLD_CRS_1 <= TDT[2]
      DO BRADD WITH 2
    CASE SOLD_CRS_1 > TDT[2] .AND. SOLD_CRS_1 <= TDT[3]
      DO BRADD WITH 3
    CASE SOLD_CRS_1 > TDT[3] .AND. SOLD_CRS_1 <= TDT[4]
      DO BRADD WITH 4
    CASE SOLD_CRS_1 > TDT[4] .AND. SOLD_CRS_1 <= TDT[5]
      DO BRADD WITH 5
    CASE SOLD_CRS_1 > TDT[5] .AND. SOLD_CRS_1 <= TDT[6]
      DO BRADD WITH 6
    CASE SOLD_CRS_1 > TDT[6] .AND. SOLD_CRS_1 <= TDT[7]
      DO BRADD WITH 7
    CASE SOLD_CRS_1 > TDT[7] .AND. SOLD_CRS_1 <= TDT[8]
      DO BRADD WITH 8
  ENDCASE
  SKIP
ENDDO
DO SIMTITLE WITH PLINE,PPAGE,SUBTITLE,'Y'
? ' '
? 'WEEK          Jhb         Pretoria    O.F.S.      N.Tvl       Durban      Cape town   E.Cape      Other'
? ' '
MCNT = 1
FOR MCNT = 1 TO 8
  ? STR(MCNT,4,0) + '     ' + STR(JCRS1[MCNT],12,0) + STR(PCRS1[MCNT],12,0) + STR(FCRS1[MCNT],12,0) + STR(NCRS1[MCNT],12,0) + STR(DCRS1[MCNT],12,0) + STR(CCRS1[MCNT],12,0) + STR(ECRS1[MCNT],12,0) + STR(OCRS1[MCNT],12,0)
  ? ' '
NEXT
shutprn()
CLOSE DATABASES
RETURN

*EOF


PROCEDURE BRADD
PARAMETER WKCNT
P_CDE = SUBSTR(P_CODE,1,4)
P_NUM = VAL(P_CODE)
DO CASE
  CASE (P_NUM > 1400 .AND. P_NUM < 2800)
    JCRS1[WKCNT] = JCRS1[WKCNT] + 1
  CASE (P_NUM > 0 .AND. P_NUM < 400);
             .OR. (P_NUM > 999 .AND. P_NUM < 1400);
             .OR. (P_NUM > 2799 .AND. P_NUM < 2900)
    PCRS1[WKCNT] = PCRS1[WKCNT] + 1
  CASE (P_NUM > 399 .AND. P_NUM < 1000)
    NCRS1[WKCNT] = NCRS1[WKCNT] + 1
  CASE (P_NUM > 9299 .AND. P_NUM < 10000);
             .OR. (P_NUM > 8299 .AND. P_NUM < 9000)
    FCRS1[WKCNT] = FCRS1[WKCNT] + 1
  CASE (P_NUM > 6699 .AND. P_NUM < 8300)
    CCRS1[WKCNT] = CCRS1[WKCNT] + 1
  CASE (P_NUM > 2899 .AND. P_NUM < 4900)
    DCRS1[WKCNT] = DCRS1[WKCNT] + 1
  CASE (P_NUM > 4899 .AND. P_NUM < 6700)
    ECRS1[WKCNT] = ECRS1[WKCNT] + 1
  OTHERWISE
    OCRS1[WKCNT] = OCRS1[WKCNT] + 1
ENDCASE
RETURN

* EOF