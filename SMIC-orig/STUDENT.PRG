*******************************************************************************
* PROGRAM 'STDJIM' UNCONTROLLED EDIT OF STUDENT
* AUTHOR JIM WEST (E.T.)
* 1/2/88

SELECT 2
IF .NOT. NET_USE('STUDENT', .F., 'STD', 'NAMES', 'STDGROUP')
  RETURN
ENDIF

SIMHEAD(PSCR_TITLE)
FINDSTD()

IF EOF()
  CLOSE DATABASE
  RETURN
ENDIF

IF .NOT. RLOCK()
  @23,10 SAY 'Student already in use - Please try later'
  INKEY(10)
  CLOSE DATABASES
  RETURN
ENDIF

SIMHEAD(PSCR_TITLE)
@3,1 SAY space(12) + 'Student edit screen'
MSTD_CODE = STD_CODE
@4,1 CLEAR
@5,5 SAY 'Account no. ' + MSTD_CODE
@5,50 SAY 'Archive no ' + ARCHIV
STORE GROUP_CD TO MGROUP_CD
STORE GROUP_NO TO MGROUP_NO
STORE START_DT TO MSTART_DT
STORE START_INDX TO MSTART_INDX
STORE LAST_TRAN TO MLAST_TRAN
STORE WK_UNACT TO MWK_UNACT
STORE WK_SMLTN TO MWK_SMLTN
STORE INITL_VAL TO MINITL_VAL
STORE FIN_PAY TO MFIN_PAY
STORE CASH TO MCASH
STORE PERC_CHANG TO MPERC_CHANG
STORE WEEK_1 TO MWEEK_1
STORE WEEK_2 TO MWEEK_2
STORE WEEK_3 TO MWEEK_3
STORE WEEK_4 TO MWEEK_4
STORE MNTH_CHANG TO MMNTH_CHANG
STORE STATUS TO MSTATUS
STORE SIMLN_LEN TO MSIMLN_LEN
STORE DEAL_REF TO MDEAL_REF
STORE FUT_CASH TO MFUT_CASH
MSTP_LS_LEV = STP_LS_LEV
@6,1 SAY 'Title: ' + TITLE
@6,15 SAY 'First name: ' + NAME
@7,15 SAY 'Surname:    ' + SURNAME
@9,1 SAY 'Start date       ' GET MSTART_DT PICTURE '@D'
@10,1 SAY 'Last transaction ' GET MLAST_TRAN PICTURE '@D'
@12,1 SAY 'Status   ' GET MSTATUS PICTURE '!'
@14,1 SAY 'Deal ref ' GET MDEAL_REF PICTURE '!'
@15,1 SAY 'Fin pay  ' GET MFIN_PAY PICTURE '!'
@17,1 SAY 'Sim length ' GET MSIMLN_LEN PICTURE '999'
@18,1 SAY 'Wk sim     ' GET MWK_SMLTN PICTURE '999'
@19,1 SAY 'Wk unact   ' GET MWK_UNACT PICTURE '999'
@21,1 SAY 'Start index ' GET MSTART_INDX PICTURE '99999999'
@6,60 SAY 'Group code ' GET MGROUP_CD
@7,40 SAY 'Group no   ' GET MGROUP_NO
@9,40 SAY 'Initl value ' GET MINITL_VAL PICTURE '9999999999.99'
@10,40 SAY 'Cash        ' GET MCASH PICTURE '9999999999.99'
@11,40 SAY 'Fut cash    ' GET MFUT_CASH PICTURE '9999999999.99'
@13,40 SAY 'Week 1      ' GET MWEEK_1 PICTURE '9999999999.99'
@14,40 SAY 'Week 2      ' GET MWEEK_2 PICTURE '9999999999.99'
@15,40 SAY 'Week 3      ' GET MWEEK_3 PICTURE '9999999999.99'
@16,40 SAY 'Week 4      ' GET MWEEK_4 PICTURE '9999999999.99'
@18,40 SAY 'Percent change  ' GET MPERC_CHANG PICTURE '999999.99'
@19,40 SAY 'Month change     ' GET MMNTH_CHANG PICTURE '99999.99'
IF MPW_LEV > 7
  @20,40 SAY 'Stop loss level  ' GET MSTP_LS_LEV PICTURE '99'
ENDIF
READ
STD->GROUP_CD := MGROUP_CD
STD->GROUP_NO := MGROUP_NO
STD->START_DT := MSTART_DT
STD->LAST_TRAN := MLAST_TRAN
STD->WK_SMLTN := MWK_SMLTN
STD->WK_UNACT := MWK_UNACT
STD->START_INDX := MSTART_INDX
STD->INITL_VAL := MINITL_VAL
STD->CASH := MCASH
STD->PERC_CHANG := MPERC_CHANG
STD->FIN_PAY := MFIN_PAY
STD->WEEK_1 := MWEEK_1
STD->WEEK_2 := MWEEK_2
STD->WEEK_3 := MWEEK_3
STD->WEEK_4 := MWEEK_4
STD->MNTH_CHANG := MMNTH_CHANG
STD->STATUS := MSTATUS
STD->SIMLN_LEN := MSIMLN_LEN
STD->DEAL_REF := MDEAL_REF
STD->FUT_CASH := MFUT_CASH
STD->STP_LS_LEV := MSTP_LS_LEV
UNLOCK
CLOSE DATABASES
RETURN
* EOF