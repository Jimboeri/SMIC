*******************************************************************************
* LDARCLB - PRINT LABELS BY ARCHIVE NUMBER
* JIM WEST

SIMHEAD(PSCR_TITLE)

@5,10 SAY 'Printing labels by archive no'

IF .NOT. NET_USE('NEWLEADS', .F., 'LD', 'ARCHIVES')
  RETURN
ENDIF

OPENPRN()
PLINE = 1
JARC = 'XXXXXXX'

DO WHILE JARC <> SPACE(7)
  STORE SPACE(7) TO MARC1
  STORE SPACE(3) TO MSRCE_CD1, MOCC1
  STORE CTOD('  /  /  ') TO MSRCE_DT1
  STORE SPACE(4) TO MTITLE1, MINTLS1, MP_CODE1
  STORE SPACE(30) TO MSUR1
  STORE SPACE(25) TO MADD11, MADD21, MADD31
  STORE SPACE(15) TO MPH_W1, MPH_H1
  STORE SPACE(7) TO MARC2
  STORE SPACE(3) TO MSRCE_CD2, MOCC2
  STORE CTOD('  /  /  ') TO MSRCE_DT2
  STORE SPACE(4) TO MTITLE2, MINTLS2, MP_CODE2
  STORE SPACE(30) TO MSUR2
  STORE SPACE(25) TO MADD12, MADD22, MADD32
  STORE SPACE(15) TO MPH_W2, MPH_H2
  MCNT = 1
  @10,0 CLEAR
  DO WHILE MCNT < 3 .AND. JARC <> SPACE(7)
    JARC = SPACE(7)
    MFND = .F.
    DO WHILE .NOT. MFND
      @((MCNT * 2) + 10),0 CLEAR
      @((MCNT * 2) + 10),10 SAY 'Archive no '  GET JARC PICTURE '!!!!!!!'
      READ
      SEEK JARC
      IF JARC = SPACE(7) .OR. .NOT. EOF()
        MFND = .T.
      ELSE
        @23,10 SAY 'Lead not found'
        INKEY(10)
      ENDIF
    ENDDO
    MM = 'MARC' + LTRIM(STR(MCNT))
    STORE ARCHIV TO &MM
    MM = 'MTITLE' + LTRIM(STR(MCNT))
    STORE TITLE TO &MM
    MM = 'MINTLS' + LTRIM(STR(MCNT))
    STORE INITLS TO &MM
    MM = 'MP_CODE' + LTRIM(STR(MCNT))
    STORE P_CODE TO &MM
    MM = 'MSUR' + LTRIM(STR(MCNT))
    STORE SURNAME TO &MM
    MM = 'MADD1' + LTRIM(STR(MCNT))
    STORE ADDRESS1 TO &MM
    MM = 'MADD2' + LTRIM(STR(MCNT))
    STORE ADDRESS2 TO &MM
    MM = 'MADD3' + LTRIM(STR(MCNT))
    STORE ADDRESS3 TO &MM
    MCNT = MCNT + 1
  ENDDO
  IF MARC1 <> SPACE(7)
    ? SPACE(20) + 'SMC ' + MARC1
    IF MARC2 <> SPACE(7)
      ?? SPACE(27) + 'SMC ' + MARC2
    ENDIF
    ? TRIM(MTITLE1) + ' ' + TRIM(MINTLS1) + ' ' + MSUR1
    MCOL = 38 - PCOL()
    ?? REPLICATE(' ',MCOL) + TRIM(MTITLE2) + ' ' + TRIM(MINTLS2) + ' ' + MSUR2
    ? MADD11 + SPACE(15) + MADD12
    ? MADD21 + SPACE(15) + MADD22
    ? MADD31 + SPACE(15) + MADD32
    ? MP_CODE1 + SPACE(36) + MP_CODE2
    ? ' '
    ? ' '
    ? ' '
  ENDIF (ARC <> SPACE)
ENDDO
SET CONSOL ON
SET PRINT OFF
CLOSE DATABASES
RETURN

*EOF
