* PROGRAM 'PARAMS'
RESTORE FROM PARAM ADDITIVE
DO SIMHEAD WITH PSCR_TITLE
@3,30 SAY 'SYSTEM PARAMETERS'
IF .NOT. NET_USE('PARAM', .F.)
  RETURN
ENDIF
IF .NOT. FLOCK()
  @23,10 SAY 'Parameter file in use - Please try later'
  INKEY(10)
ENDIF

CARRYON = .T.
DO WHILE CARRYON
  @5,0 CLEAR
	TEXT

             WHAT DO YOU WANT TO CHANGE

             1    DATE OF LAST PORTFOLIO UPDATE
             2    OVER-DRAFT LIMIT
             3    INTEREST PAYABLE ON BALANCE
             4    INTEREST DUE ON OVER-DRAFT

             9    EXIT PROGRAM AND UPDATE PARAMETER FILE
  ENDTEXT  
  @20,5 CLEAR
  STORE ' ' TO OPTION
  WAIT 'SELECT OPTION ' TO OPTION
  STORE UPPER(OPTION) TO OPTION
  CARRYON = .T.
  DO CASE
    CASE OPTION = '1'
      @4,0 CLEAR
      NEWDATE = CTOD('  /  /  ')
      @5,1 SAY 'CURRENT DATE OF LAST PORTFOLIO UPDATE IS ' + DTOC(PLST_UPDTE)
      @7,1 SAY 'ENTER NEW DATE OF LAST PORTFOLIO UPDATE ' GET NEWDATE PICTURE '@D'
      READ
      @10,1 SAY 'NEW DATE OF LAST PORTFOLIO UPDATE IS     ' + DTOC(NEWDATE)
      STORE 'X' TO YESNO
      DO WHILE 'Y'<>YESNO .AND. 'N'<>YESNO
        @14,0 CLEAR
        WAIT 'PROCEED (Y/N) ? ' TO YESNO
        STORE UPPER(YESNO) TO YESNO
      ENDDO
      IF YESNO = 'Y'
        REPLACE LST_UPDTE WITH NEWDATE
      ENDIF
    CASE OPTION = '2'
      @4,0 CLEAR
      NEWLIM = 0
      @5,1 SAY 'CURRENT OVERDRAFT LIMIT IS '
      @5,26 SAY POVRDRFT_LM
      @7,1 SAY 'ENTER NEW OVERDRAFT LIMIT ' GET NEWLIM PICTURE '99999999.99'
      READ
      @10,1 SAY 'NEW OVERDRAFT LIMIT IS     ' 
      @10,28 SAY NEWLIM
      STORE 'X' TO YESNO
      DO WHILE 'Y'<>YESNO .AND. 'N'<>YESNO
        @14,0 CLEAR
        WAIT 'PROCEED (Y/N) ? ' TO YESNO
        STORE UPPER(YESNO) TO YESNO
      ENDDO
      IF YESNO = 'Y'
        REPLACE OVRDRFT_LM WITH NEWLIM
      ENDIF
    CASE OPTION = '3'
      @4,0 CLEAR
      NEWINT = 0
      @5,1 SAY 'CURRENT INTEREST PAYABLE ON BALANCE IS ' 
      @5,38 SAY PSCR_INT
      @7,1 SAY 'ENTER NEW INTEREST PAYABLE ON BALANCE ' GET NEWINT PICTURE '99999999.99'
      READ
      @10,1 SAY 'NEW INTEREST PAYABLE ON BALANCE IS     ' 
      @10,40 SAY NEWINT
      STORE 'X' TO YESNO
      DO WHILE 'Y'<>YESNO .AND. 'N'<>YESNO
        @14,0 CLEAR
        WAIT 'PROCEED (Y/N) ? ' TO YESNO
        STORE UPPER(YESNO) TO YESNO
      ENDDO
      IF YESNO = 'Y'
        REPLACE INTEREST WITH NEWINT
      ENDIF
    CASE OPTION = '4'
      @4,0 CLEAR
      NEWLEND = 0
      @5,1 SAY 'CURRENT INTEREST TO BE PAID ON OVERDRAFT IS '
      @5,43 SAY PSCR_LEND
      @7,1 SAY 'ENTER NEW INTEREST TO BE PAID ON OVERDRAFT ' GET NEWLEND PICTURE '99999999.99'
      READ
      @10,1 SAY 'NEW INTEREST TO BE PAID ON OVERDRAFT IS     '
      @10,45 SAY NEWLEND
      STORE 'X' TO YESNO
      DO WHILE 'Y'<>YESNO .AND. 'N'<>YESNO
        @14,0 CLEAR
        WAIT 'PROCEED (Y/N) ? ' TO YESNO
        STORE UPPER(YESNO) TO YESNO
      ENDDO
      IF YESNO = 'Y'
        REPLACE LENDING WITH NEWLEND
      ENDIF
    CASE OPTION = '9'
      CARRYON = .F.
  ENDCASE
ENDDO (CARRYON = .T.)
SAVE TO TEMPMEM
CLEAR MEMORY
STORE SCR_TITLE TO PSCR_TITLE
STORE PRNT_TITLE TO PPNT_TITLE
STORE OVRDRFT_LM TO POVRDRFT_LM
STORE LST_PRICE TO PLST_PRICE
SAVE TO PARAM
UNLOCK
CLOSE DATABASE
RESTORE FROM TEMPMEM
RETURN
* EOF