*******************************************************************************
* STDNAMLB - PRINS LABELS FOR STUDENTS
* JIM WEST

LOCAL nMCNT

DRAW_BOX(4,2,20,76)

@5,10 SAY 'Printing labels by student name'

DO WHILE .NOT. EOF()
  STORE SPACE(5) TO MSTD1, MSTD2
  STORE SPACE(4) TO MTITLE1, MP_CODE1
  STORE ' ' TO MINITL1
  STORE SPACE(30) TO MSUR1
  STORE SPACE(25) TO MADD11, MADD21, MADD31
  STORE SPACE(4) TO MTITLE2, MP_CODE2
  STORE ' ' TO MINITL2
  STORE SPACE(30) TO MSUR2
  STORE SPACE(25) TO MADD12, MADD22, MADD32
  nMCNT = 1
  DO WHILE nMCNT < 3 .AND. .NOT. EOF()
    FINDSTD()
    IF .NOT. EOF()
      MM = 'MSTD' + LTRIM(STR(nMCNT))
      STORE STD_CODE TO &MM
      MM = 'MTITLE' + LTRIM(STR(nMCNT))
      STORE TITLE TO &MM
      MM = 'MINITL' + LTRIM(STR(nMCNT))
      STORE SUBSTR(NAME,1,1) TO &MM
      MM = 'MP_CODE' + LTRIM(STR(nMCNT))
      STORE P_CODE TO &MM
      MM = 'MSUR' + LTRIM(STR(nMCNT))
      STORE SURNAME TO &MM
      MM = 'MADD1' + LTRIM(STR(nMCNT))
      STORE ADDRESS1 TO &MM
      MM = 'MADD2' + LTRIM(STR(nMCNT))
      STORE ADDRESS2 TO &MM
      MM = 'MADD3' + LTRIM(STR(nMCNT))
      STORE ADDRESS3 TO &MM
      nMCNT++
    ENDIF
  ENDDO
  IF MSUR1 <> SPACE(30)
    SET PRINT ON
    SET CONSOL OFF
    ? SPACE(20) + 'SMC/STD' + MSTD1
    IF MSTD2 <> SPACE(5)
      ?? SPACE(25) + 'SMC/STD' + MSTD2
    ENDIF
    ? TRIM(MTITLE1) + ' ' + TRIM(MINITL1) + ' ' + MSUR1
    MCOL = 40 - PCOL()
    ?? REPLICATE(' ',MCOL) + TRIM(MTITLE2) + ' ' + TRIM(MINITL2) + ' ' + MSUR2
    ? MADD11 + SPACE(15) + MADD12
    ? MADD21 + SPACE(15) + MADD22
    ? MADD31 + SPACE(15) + MADD32
    ? MP_CODE1 + SPACE(36) + MP_CODE2
    ? ' '
    ? ' '
    ? ' '
    SET CONSOL ON
    SET PRINT OFF
  ENDIF (ARC <> SPACE)
ENDDO
CLOSE DATABASES
RETURN

*EOF