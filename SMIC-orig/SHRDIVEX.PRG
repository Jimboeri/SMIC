* PROGRAM 'SHRDIVEX' USED FOR EXTRACTING DIVIDENDS TO A TEXT FILE
* AUTHOR JIM WEST (E.T.)
* 1/2/88

DO SIMHEAD WITH PSCR_TITLE
@2,30 SAY 'Share dividend extract'

IF .NOT. NET_USE('SHRDESCR', .F., 'DES', 'SHRDESCR')
  RETURN
ENDIF

SET ALTERNATE TO DIVIDEND.TXT
SET ALTERNATE ON
SET CONSOLE OFF
?? 'SHARE            AMOUNT   L.D.R.'
? '--------------------------------'
DO WHILE .NOT. EOF()
  @10,10 SAY SHARE
  IF DTOC(DIV_DT) <> '  /  /  '
    ? SHARE + '   ' + DIV_TYPE + ' ' + STR(DIVIDEND) + 'c ' + DTOC(DIV_DT)
  ENDIF
  SKIP
ENDDO (SHARE <> SPACE)
SET CONSOLE ON
SET ALTERNATE OFF
CLOSE ALTERNATE
CLOSE DATABASES
RETURN
* EOF
